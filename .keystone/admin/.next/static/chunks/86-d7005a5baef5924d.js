(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{1086:function(e,t,i){"use strict";i.d(t,{p:function(){return getItemPage}});var l=i(7896),n=i(4273),a=i.n(n),o=i(5632),r=i(2784),s=i(5631),d=i(5445),u=i(6759),c=i(3123),m=i(8999),g=i(3900),v=i(5364),p=i(8626),h=i(2445),f=i(1054),Z=i(4163);i(928);var y=i(6928),x=i(3379),b=i(81),w=i(794),C=i(5360),k=i(8023),S=i(8346),I=i(5478),F=i(7035),$=i(9258);function useEventCallback(e){let t=(0,r.useRef)(e),i=(0,r.useCallback)((...e)=>t.current(...e),[]);return(0,r.useEffect)(()=>{t.current=e}),i}function ItemForm({listKey:e,itemGetter:t,selectedFields:i,fieldModes:n,fieldPositions:o,showDelete:u,item:m}){var g,w,k;let F=(0,C.sm)(e),{spacing:$,typography:E}=(0,d.Fg)(),[D,{loading:L,error:N,data:M}]=(0,x.D)(b.Ps`mutation ($data: ${F.gqlNames.updateInputName}!, $id: ID!) {
      item: ${F.gqlNames.updateMutationName}(where: { id: $id }, data: $data) {
        ${i}
      }
    }`,{errorPolicy:"all"});t=null!==(g=(0,r.useMemo)(()=>{if(M)return(0,f.m)(M,null==N?void 0:N.graphQLErrors).get("item")},[M,N]))&&void 0!==g?g:t;let[T,P]=(0,r.useState)(()=>{let e=(0,y.d)(F.fields,t);return{value:e,item:t}});if(!L&&T.item.data!==t.data&&(t.errors||[]).every(e=>{var t;return(null===(t=e.path)||void 0===t?void 0:t.length)!==1})){let e=(0,y.d)(F.fields,t);P({value:e,item:t})}let{changedFields:z,dataForUpdate:B}=(0,y.u)(F.fields,T.item,T.value),q=(0,y.a)(F.fields,T.value),[W,j]=(0,r.useState)(!1),A=(0,v.e)(),O=useEventCallback(()=>{let e=0!==q.size;j(e),e||D({variables:{data:B,id:T.item.get("id").data}}).then(({errors:e})=>{let t=null==e?void 0:e.find(e=>{var t;return void 0===e.path||(null===(t=e.path)||void 0===t?void 0:t.length)===1});t?A.addToast({title:"Failed to update item",tone:"negative",message:t.message}):A.addToast({tone:"positive",title:"Saved successfully"})}).catch(e=>{A.addToast({title:"Failed to update item",tone:"negative",message:e.message})})}),H=F.isSingleton?F.label:null===(w=T.item.data)||void 0===w?void 0:w[F.labelField],V=null===(k=T.item.data)||void 0===k?void 0:k.id,K=!!z.size;return(0,I.u)((0,r.useMemo)(()=>({current:K}),[K])),(0,d.tZ)(r.Fragment,null,(0,d.tZ)(d.xu,{marginTop:"xlarge"},(0,d.tZ)(S.G,{networkError:null==N?void 0:N.networkError,errors:null==N?void 0:N.graphQLErrors.filter(e=>{var t;return(null===(t=e.path)||void 0===t?void 0:t.length)===1})}),(0,d.tZ)(Z.F,{groups:F.groups,fieldModes:n,fields:F.fields,forceValidation:W,invalidFields:q,position:"form",fieldPositions:o,onChange:(0,r.useCallback)(e=>{P(t=>({item:t.item,value:e(t.value)}))},[P]),value:T.value}),(0,d.tZ)(R,{onSave:O,hasChangedFields:!!z.size,onReset:useEventCallback(()=>{P(e=>({item:e.item,value:(0,y.d)(F.fields,e.item)}))}),loading:L,deleteButton:(0,r.useMemo)(()=>u?(0,d.tZ)(DeleteButton,{list:F,itemLabel:null!=H?H:V,itemId:V}):void 0,[u,F,H,V])})),(0,d.tZ)(StickySidebar,null,(0,d.tZ)(h.Qy,null,"Item ID"),(0,d.tZ)("div",{css:{display:"flex",alignItems:"center"}},(0,d.tZ)(h.oi,{css:{marginRight:$.medium,fontFamily:E.fontFamily.monospace,fontSize:E.fontSize.small},readOnly:!0,value:m.id}),(0,d.tZ)(p.u,{content:"Copy ID"},e=>(0,d.tZ)(s.zx,(0,l.Z)({},e,{"aria-label":"Copy ID",onClick:()=>{a()(m.id)}}),(0,d.tZ)(c.K,{size:"small"})))),(0,d.tZ)(d.xu,{marginTop:"xlarge"},(0,d.tZ)(Z.F,{groups:F.groups,fieldModes:n,fields:F.fields,forceValidation:W,invalidFields:q,position:"sidebar",fieldPositions:o,onChange:(0,r.useCallback)(e=>{P(t=>({item:t.item,value:e(t.value)}))},[P]),value:T.value}))))}function DeleteButton({itemLabel:e,itemId:t,list:i}){let l=(0,v.e)(),[n,{loading:a}]=(0,x.D)(b.Ps`mutation ($id: ID!) {
      ${i.gqlNames.deleteMutationName}(where: { id: $id }) {
        id
      }
    }`,{variables:{id:t}}),[u,c]=(0,r.useState)(!1),g=(0,o.useRouter)();return(0,d.tZ)(r.Fragment,null,(0,d.tZ)(s.zx,{tone:"negative",onClick:()=>{c(!0)}},"Delete"),(0,d.tZ)(m.aR,{title:"Delete Confirmation",isOpen:u,tone:"negative",actions:{confirm:{label:"Delete",action:async()=>{try{await n()}catch(t){return l.addToast({title:`Failed to delete ${i.singular} item: ${e}`,message:t.message,tone:"negative"})}return g.push(i.isSingleton?"/":`/${i.path}`),l.addToast({title:e,message:`Deleted ${i.singular} item successfully`,tone:"positive"})},loading:a},cancel:{label:"Cancel",action:()=>{c(!1)}}}},"Are you sure you want to delete ",(0,d.tZ)("strong",null,e),"?"))}i(9378),i(6819),i(4002),i(9393),i(7668),i(1168),i(5976),i(581),i(6763),i(3818),i(487),i(891),i(5273),i(1511),i(9097),i(7729),i(6987);let getItemPage=e=>()=>(0,d.tZ)(ItemPage,e);function ItemPage({listKey:e}){var t,i;let l=(0,C.sm)(e),n=(0,o.useRouter)().query.id,{query:a,selectedFields:s}=(0,r.useMemo)(()=>{let e=Object.entries(l.fields).filter(([e,t])=>"id"===e||"hidden"!==t.itemView.fieldMode).map(([e])=>l.fields[e].controller.graphqlSelection).join("\n");return{selectedFields:e,query:b.Ps`
        query ItemPage($id: ID!, $listKey: String!) {
          item: ${l.gqlNames.itemQueryName}(where: {id: $id}) {
            ${e}
          }
          keystone {
            adminMeta {
              list(key: $listKey) {
                hideCreate
                hideDelete
                fields {
                  path
                  itemView(id: $id) {
                    fieldMode
                    fieldPosition
                  }
                }
              }
            }
          }
        }
      `}},[l]),{data:c,error:m,loading:v}=(0,w.a)(a,{variables:{id:n,listKey:e},errorPolicy:"all",skip:void 0===n}),p=(0,f.m)(c,null==m?void 0:m.graphQLErrors),h=(0,r.useMemo)(()=>{var e;let t={};return null===(e=p.data)||void 0===e||null===(e=e.keystone)||void 0===e||null===(e=e.adminMeta)||void 0===e||null===(e=e.list)||void 0===e||null===(e=e.fields)||void 0===e||e.forEach(e=>{var i;null!==e&&null!==e.path&&(null==e||null===(i=e.itemView)||void 0===i?void 0:i.fieldMode)!=null&&(t[e.path]=e.itemView.fieldMode)}),t},[null===(t=p.data)||void 0===t||null===(t=t.keystone)||void 0===t||null===(t=t.adminMeta)||void 0===t||null===(t=t.list)||void 0===t?void 0:t.fields]),Z=(0,r.useMemo)(()=>{var e;let t={};return null===(e=p.data)||void 0===e||null===(e=e.keystone)||void 0===e||null===(e=e.adminMeta)||void 0===e||null===(e=e.list)||void 0===e||null===(e=e.fields)||void 0===e||e.forEach(e=>{var i;null!==e&&null!==e.path&&(null==e||null===(i=e.itemView)||void 0===i?void 0:i.fieldPosition)!=null&&(t[e.path]=e.itemView.fieldPosition)}),t},[null===(i=p.data)||void 0===i||null===(i=i.keystone)||void 0===i||null===(i=i.adminMeta)||void 0===i||null===(i=i.list)||void 0===i?void 0:i.fields]),y=v||void 0===n,x=p.get("keystone").errors,I=l.isSingleton?l.label:y?void 0:c&&c.item&&(c.item[l.labelField]||c.item.id)||n;return(0,d.tZ)(k.P,{title:I,header:(0,d.tZ)($.I,{list:l,label:y?"Loading...":c&&c.item&&(c.item[l.labelField]||c.item.id)||n})},y?(0,d.tZ)(d.M5,{css:{height:`calc(100vh - ${k.H}px)`}},(0,d.tZ)(u.xg,{label:"Loading item data",size:"large",tone:"passive"})):x?(0,d.tZ)(d.xu,{marginY:"xlarge"},(0,d.tZ)(g.qX,{tone:"negative"},x[0].message)):(0,d.tZ)($.C,null,(null==c?void 0:c.item)==null?(0,d.tZ)(d.xu,{marginY:"xlarge"},null!=m&&m.graphQLErrors.length||null!=m&&m.networkError?(0,d.tZ)(S.G,{errors:null==m?void 0:m.graphQLErrors,networkError:null==m?void 0:m.networkError}):l.isSingleton?"1"===n?(0,d.tZ)(d.Kq,{gap:"medium"},(0,d.tZ)(g.qX,{tone:"negative"},l.label," doesn't exist or you don't have access to it."),!c.keystone.adminMeta.list.hideCreate&&(0,d.tZ)(F.C,{list:l})):(0,d.tZ)(g.qX,{tone:"negative"},'The item with id "',n,'" does not exist'):(0,d.tZ)(g.qX,{tone:"negative"},'The item with id "',n,"\" could not be found or you don't have access to it.")):(0,d.tZ)(r.Fragment,null,(0,d.tZ)(ItemForm,{fieldModes:h,fieldPositions:Z,selectedFields:s,showDelete:!c.keystone.adminMeta.list.hideDelete,listKey:e,itemGetter:p.get("item"),item:c.item}))))}let R=(0,r.memo)(function({hasChangedFields:e,loading:t,onSave:i,onReset:l,deleteButton:n}){return(0,d.tZ)($.B,null,(0,d.tZ)(s.zx,{isDisabled:!e,isLoading:t,weight:"bold",tone:"active",onClick:i},"Save changes"),(0,d.tZ)(d.Kq,{align:"center",across:!0,gap:"small"},e?(0,d.tZ)(ResetChangesButton,{onReset:l}):(0,d.tZ)(d.xv,{weight:"medium",paddingX:"large",color:"neutral600"},"No changes"),n))});function ResetChangesButton(e){let[t,i]=(0,r.useState)(!1);return(0,d.tZ)(r.Fragment,null,(0,d.tZ)(s.zx,{weight:"none",onClick:()=>{i(!0)}},"Reset changes"),(0,d.tZ)(m.aR,{actions:{confirm:{action:()=>e.onReset(),label:"Reset changes"},cancel:{action:()=>i(!1),label:"Cancel"}},isOpen:t,title:"Are you sure you want to reset changes?",tone:"negative"},null))}let StickySidebar=e=>{let{spacing:t}=(0,d.Fg)();return(0,d.tZ)("div",(0,l.Z)({css:{marginTop:t.xlarge,marginBottom:t.xxlarge,position:"sticky",top:t.xlarge}},e))}},7035:function(e,t,i){"use strict";i.d(t,{C:function(){return CreateButtonLink}});var l=i(5631),n=i(5445),a=i(1511);function CreateButtonLink(e){return(0,n.tZ)(l.zx,{css:{textDecoration:"none",":hover":{color:"white"}},as:a.rU,href:`/${e.list.path}/create`,tone:"active",size:"small",weight:"bold"},"Create ",e.list.singular)}},8023:function(e,t,i){"use strict";i.d(t,{H:function(){return g},P:function(){return PageContainer}});var l=i(7896),n=i(5445),a=i(2784),o=i(3818),r=i(5632);i(5631),i(487),i(891),i(5273);var s=i(5360),d=i(1511),u=i(6987),c=i(9097),m=i.n(c);let Logo=()=>{var e;let{spacing:t}=(0,n.Fg)(),{adminConfig:i}=(0,s.jf)();return null!==(e=i.components)&&void 0!==e&&e.Logo?(0,n.tZ)(i.components.Logo,null):(0,n.tZ)(n.H3,null,(0,n.tZ)(m(),{href:"/",css:{backgroundImage:"linear-gradient(to right, #0ea5e9, #6366f1)",backgroundClip:"text",lineHeight:"1.75rem",color:"transparent",verticalAlign:"middle",transition:"color 0.3s ease",textDecoration:"none"}},(0,n.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 220 220",css:{display:"inline-block",width:"2rem",height:"2rem",margin:`0  ${t.medium}px ${t.xsmall}px 0`,verticalAlign:"middle"}},(0,n.tZ)("defs",null,(0,n.tZ)("linearGradient",{id:"logo-a",x1:"0%",x2:"50%",y1:"0%",y2:"71.9%"},(0,n.tZ)("stop",{offset:"0%",stopColor:"#5AE8FA"}),(0,n.tZ)("stop",{offset:"100%",stopColor:"#2684FF"}))),(0,n.tZ)("path",{fill:"url(#logo-a)",fillRule:"evenodd",d:"M290.1 47h117.5c17.8 0 24.3 1.9 30.8 5.3a36.3 36.3 0 0115.1 15.2c3.5 6.5 5.4 13 5.4 30.8v117.4c0 17.9-1.9 24.3-5.4 30.8a36.3 36.3 0 01-15.1 15.2c-6.5 3.4-13 5.3-30.8 5.3H290c-17.8 0-24.3-1.9-30.8-5.3a36.3 36.3 0 01-15.1-15.2c-3.5-6.5-5.3-13-5.3-30.8V98.3c0-17.9 1.8-24.3 5.3-30.8a36.3 36.3 0 0115.1-15.2c6.5-3.4 13-5.3 30.8-5.3zm11.8 56.8V218H327v-36.8l14.4-14.6 34.4 51.4h31.5l-49-69.1 44.7-45.1h-31.3L327 151v-47.3H302z",transform:"translate(-238.9 -47)"})),"Keystone 6"))},NavItem=({href:e,children:t,isSelected:i})=>{let{colors:l,palette:a,spacing:o,radii:s,typography:u}=(0,n.Fg)(),c=(0,r.useRouter)(),m=void 0!==i?i:c.pathname===e;return(0,n.tZ)("li",null,(0,n.tZ)(d.rU,{"aria-current":!!m&&"location",href:e,css:{background:"transparent",borderBottomRightRadius:s.xsmall,borderTopRightRadius:s.xsmall,color:a.neutral700,display:"block",fontWeight:u.fontWeight.medium,marginBottom:o.xsmall,marginRight:o.xlarge,padding:`${o.small}px ${o.xlarge}px`,position:"relative",textDecoration:"none",":hover":{background:l.backgroundHover,color:l.linkHoverColor},"&[aria-current=location]":{background:a.neutral200,color:a.neutral900}}},t))},AuthenticatedItemDialog=({item:e})=>{let{apiPath:t}=(0,s.jf)(),{spacing:i,typography:l}=(0,n.Fg)();return(0,n.tZ)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",margin:i.xlarge,marginBottom:0}},!!e&&"authenticated"===e.state&&(0,n.tZ)("div",{css:{fontSize:l.fontSize.small}},"Signed in as ",(0,n.tZ)("strong",{css:{display:"block"}},e.label)),e&&"authenticated"===e.state&&(0,n.tZ)(u.S,null))},NavigationContainer=({authenticatedItem:e,children:t})=>{let{spacing:i}=(0,n.Fg)();return(0,n.tZ)("div",{css:{display:"flex",flexDirection:"column",justifyContent:"center",position:"relative"}},(0,n.tZ)(AuthenticatedItemDialog,{item:e}),(0,n.tZ)("nav",{role:"navigation","aria-label":"Side Navigation",css:{marginTop:i.xlarge}},(0,n.tZ)("ul",{css:{padding:0,margin:0,li:{listStyle:"none"}}},t)))},ListNavItem=({list:e})=>{let t=(0,r.useRouter)();return(0,n.tZ)(NavItem,{isSelected:t.pathname.split("/")[1]===`/${e.path}`.split("/")[1],href:`/${e.path}${e.isSingleton?"/1":""}`},e.label)},ListNavItems=({lists:e=[],include:t=[]})=>{let i=t.length>0?e.filter(e=>t.includes(e.key)):e;return(0,n.tZ)(a.Fragment,null,i.map(e=>(0,n.tZ)(ListNavItem,{key:e.key,list:e})))},Navigation=()=>{var e;let{adminMeta:{lists:t},adminConfig:i,authenticatedItem:l,visibleLists:a}=(0,s.jf)();if("loading"===a.state)return null;if("error"===a.state)return(0,n.tZ)(n.xv,{as:"span",paddingLeft:"xlarge",css:{color:"red"}},a.error instanceof Error?a.error.message:a.error[0].message);let o=Object.keys(t).map(e=>a.lists.has(e)?t[e]:null).filter(e=>!!e);return null!=i&&null!==(e=i.components)&&void 0!==e&&e.Navigation?(0,n.tZ)(i.components.Navigation,{authenticatedItem:l,lists:o}):(0,n.tZ)(NavigationContainer,{authenticatedItem:l},(0,n.tZ)(NavItem,{href:"/"},"Dashboard"),(0,n.tZ)(ListNavItems,{lists:o}))},g=80,PageWrapper=e=>(0,n.tZ)(a.Fragment,null,(0,n.tZ)("style",null,"body { overflow: hidden; }"),(0,n.tZ)("div",(0,l.Z)({css:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr)",gridTemplateRows:`repeat(2,${g}px) auto`,height:"100vh",isolation:"isolate","@media (min-width: 576px)":{gridTemplateColumns:"minmax(300px, 1fr) 4fr",gridTemplateRows:`${g}px auto`}}},e))),Sidebar=({isSidebarOpen:e,...t})=>(0,n.tZ)("div",{css:{gridColumn:"1/2",gridRow:"2/4",display:e?"block":"none",height:"100vh","@media (min-width: 576px)":{gridColumn:"1/2",gridRow:"2/3",display:"block",height:"100%"},overflowY:"auto",WebkitOverflowScrolling:"touch"}},(0,n.tZ)("aside",(0,l.Z)({css:{minWidth:0,WebkitOverflowScrolling:"touch"}},t))),Content=e=>{let{colors:t,spacing:i}=(0,n.Fg)();return(0,n.tZ)("main",(0,l.Z)({css:{backgroundColor:t.background,boxSizing:"border-box",minWidth:0,paddingLeft:i.xlarge,paddingRight:i.xlarge,overflowY:"auto",WebkitOverflowScrolling:"touch",position:"relative"}},e))},PageContainer=({children:e,header:t,title:i})=>{let{colors:l,spacing:r}=(0,n.Fg)(),[s,d]=(0,a.useState)(!1);return(0,n.tZ)(PageWrapper,null,(0,n.tZ)("div",{css:{alignItems:"center",borderBottom:`1px solid ${l.border}`,display:"flex",justifyContent:"space-between",paddingLeft:r.xlarge,paddingRight:r.xlarge}},(0,n.tZ)(Logo,null),(0,n.tZ)("div",{onClick:()=>{d(!s)},css:{display:"block","@media (min-width: 576px)":{display:"none"}}},s?(0,n.tZ)(o.oOx,null):(0,n.tZ)(o.Oqj,null))),(0,n.tZ)("header",{css:{alignItems:"center",backgroundColor:l.background,borderBottom:`1px solid ${l.border}`,display:"flex",justifyContent:"space-between",minWidth:0,paddingLeft:r.xlarge,paddingRight:r.xlarge,visibility:s?"hidden":"visible"}},(0,n.tZ)("title",null,i?`Keystone - ${i}`:"Keystone"),(0,n.tZ)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),t),(0,n.tZ)(Sidebar,{isSidebarOpen:s},(0,n.tZ)(Navigation,null)),(0,n.tZ)(Content,null,e))}},9258:function(e,t,i){"use strict";i.d(t,{B:function(){return BaseToolbar},C:function(){return ColumnLayout},I:function(){return ItemPageHeader}});var l=i(7896),n=i(5445),a=i(5273),o=i(2784),r=i(1511);let Container=({children:e,...t})=>(0,n.tZ)("div",(0,l.Z)({css:{minWidth:0,maxWidth:1080}},t),e);function ItemPageHeader(e){let{palette:t,spacing:i}=(0,n.Fg)();return(0,n.tZ)(Container,{css:{alignItems:"center",display:"flex",flex:1,justifyContent:"space-between"}},(0,n.tZ)("div",{css:{alignItems:"center",display:"flex",flex:1,minWidth:0}},e.list.isSingleton?(0,n.tZ)(n.X6,{type:"h3"},e.list.label):(0,n.tZ)(o.Fragment,null,(0,n.tZ)(n.X6,{type:"h3"},(0,n.tZ)(r.rU,{href:`/${e.list.path}`,css:{textDecoration:"none"}},e.list.label)),(0,n.tZ)("div",{css:{color:t.neutral500,marginLeft:i.xsmall,marginRight:i.xsmall}},(0,n.tZ)(a.X,null)),(0,n.tZ)(n.X6,{as:"h1",type:"h3",css:{minWidth:0,maxWidth:"100%",overflow:"hidden",flex:1,textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.label))))}function ColumnLayout(e){let{spacing:t}=(0,n.Fg)();return(0,n.tZ)(Container,{css:{position:"relative",height:"100%"}},(0,n.tZ)("div",(0,l.Z)({css:{alignItems:"start",display:"grid",gap:t.none,gridTemplateColumns:"100vw","@media (min-width: 576px)":{gridTemplateColumns:"2fr 1fr",gap:t.xlarge}}},e)))}function BaseToolbar(e){let{colors:t,spacing:i}=(0,n.Fg)();return(0,n.tZ)("div",{css:{background:t.background,borderTop:`1px solid ${t.border}`,bottom:0,display:"flex",justifyContent:"space-between",marginTop:i.xlarge,paddingBottom:i.xlarge,paddingTop:i.xlarge,position:"sticky",zIndex:20}},e.children)}},4273:function(e){function makeError(){return new DOMException("The request is not allowed","NotAllowedError")}async function copyClipboardApi(e){if(!navigator.clipboard)throw makeError();return navigator.clipboard.writeText(e)}async function copyExecCommand(e){let t=document.createElement("span");t.textContent=e,t.style.whiteSpace="pre",t.style.webkitUserSelect="auto",t.style.userSelect="all",document.body.appendChild(t);let i=window.getSelection(),l=window.document.createRange();i.removeAllRanges(),l.selectNode(t),i.addRange(l);let n=!1;try{n=window.document.execCommand("copy")}finally{i.removeAllRanges(),window.document.body.removeChild(t)}if(!n)throw makeError()}async function clipboardCopy(e){try{await copyClipboardApi(e)}catch(t){try{await copyExecCommand(e)}catch(e){throw e||t||makeError()}}}/*! clipboard-copy. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */e.exports=clipboardCopy}}]);